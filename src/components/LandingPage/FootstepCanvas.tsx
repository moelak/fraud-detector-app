// components/Footsteps.tsx
import { useEffect, useState } from 'react';

const foot = [
  [50.86759744022923,-21.798383338076917,54.16000854997335,-23.917474843549847,57.778065334829385,-25.310771525314685,61.579706305344985,-24.823762596975733,65.0168431653022,-22.69100336700319,65.22736925598322,-19.777045647294724,63.09649708656406,-16.826669881834157,59.66512409715465,-15.356252875428147,56.12216018899968,-14.92259970211097,52.06404407417057,-16.231839553378,50.2945579442406,-18.938589556263246],
  [60.12039562389232,-12.45714817900668,63.92394094034509,-14.994440399059425,68.75013312287521,-15.737202635924493,73.10937504616481,-14.878459739068003,76.36064492186433,-12.559833524837757,77.6863729180915,-9.181208344485064,75.4625672565435,-5.673231626251427,71.79886053681197,-3.7381471592011817,66.8618942467243,-3.4903609701416993,62.29264392518654,-5.1248680438596885,58.98975517513061,-8.760952968033395],
  [65.57414109270752,1.1797411270282658,69.37768640916029,-1.3575510930244814,74.20387859169041,-2.1003133298895467,78.56312051498001,-1.241570433033059,81.81439039067953,1.0770557811971881,83.14011838690669,4.455680961549877,80.9163127253587,7.963657679783514,77.25260600562717,9.898742146833756,72.3156397155395,10.146528335893239,67.74638939400174,8.512021262175251,64.44350064394581,4.875936338001546],
  [65.89915812212375,15.917267748549033,69.97688522977245,12.635767809535894,76.25232402290966,11.736330263416008,81.47328014710077,12.477566678331382,86.09545897877996,15.579569438835726,86.99032987455637,21.425830739951824,83.82647235747945,24.97297628549917,79.18353918133074,27.064789354098487,73.69821507617947,27.23418460503707,68.46309469655478,24.972976285499172,64.88602415530316,20.55351481505123],
  [58.48881251239855,36.09589759380796,65.7080603859302,29.82038065752831,74.19222753183148,28.331948884004674,82.75081761131048,31.085582242549528,88.10923922724437,34.28575070762116,91.45825273720305,41.65358042953028,87.067323913035,47.45853718012533,79.77391671356942,50.28659303297933,71.73628428966856,50.06332546564875,64.14518700042888,47.45853718012533,60.12637078847845,42.69549574373964],
];

const path = [
  [580, 300], [600, 360], [620, 420], [640, 480], [660, 540],
  [680, 600], [700, 660], [720, 720], [740, 780], [760, 840]
];

function Foot({ x, y, index }: { x: number; y: number; index: number }) {
  const [footPath, setFootPath] = useState<string>('');

  useEffect(() => {
    // flatten foot array into a path string
    const d = foot.map(points => {
      return `M ${points[0] + x} ${points[1] + y} ` + points.slice(2).reduce((acc, val, i) => {
        const coord = i % 2 === 0 ? val + x : val + y;
        return acc + ' ' + coord;
      }, '');
    }).join(' ');
    setFootPath(d);
  }, [x, y]);

  return (
    <path
      d={footPath}
      fill='white'
      transform={`rotate(${index % 2 === 0 ? 20 : -20} ${x} ${y}) scale(${index % 2 === 0 ? 0.25 : -0.25}, 0.25)`}
      opacity={0.9}
    />
  );
}

export default function Footsteps() {
  return (
    <svg className='absolute top-0 left-0 w-full h-full pointer-events-none z-10'>
      {path.map(([x, y], i) => (
        <Foot key={i} x={x} y={y} index={i} />
      ))}
    </svg>
  );
}
