import { useEffect, useRef } from 'react';

const path = [
  56.20191403126277, 162.4451015086347, 83.38688266344644, 172.80127602121507, 107.98280549274708,
  192.86637096042372, 121.57528916149568, 221.34586055208607, 124.81159479691195, 256.2979614145819,
  141.64038410107662, 293.8391067854107, 168.82535143857336, 311.9624183437419, 203.77745230106916,
  336.5583411729056, 238.0822920364817, 344.9727358249879, 278.2124819156436, 341.0891690624884,
  316.40088841355566, 329.43846877498976, 343.58585575105235, 310.6678960895754, 370.77082308854904,
  275.7157952270795, 359.12012280105046, 244.64726112708325, 344.23311687813566, 207.10611575625444,
  355.23655603855093, 168.9177092583423, 394.0722236635463, 137.2019140312628, 438.0859803052077,
  137.84917515834604, 487.27782596353507, 174.0957982750084, 507.9901820301992, 221.9931216791693,
  513.1682710468652, 269.243183956247, 500.87030963228347, 318.43502961457443, 480.1579535656192,
  354.68165273123674, 453.62744426338134, 396.86543776550707, 414.1445200788371, 427.9340428271046,
  372.7198079555102, 447.3518767949864, 320.2916566617712, 442.173787778395, 272.39433325761024,
  427.9340429825634, 218.02439858261675, 441.5265266513118, 185.66134222845398, 472.59506075130815,
  160.418158272207, 514.6670340117198, 168.2291881671332, 557.5405924870362, 200.59229872785795,
  598.9654951914354, 232.9553551615553, 627.4449850627141, 273.08554504131894, 651.3936467669101,
  320.3356073183967, 663.0443470544095, 368.2329307225576, 663.6916081814927, 417.4247763808851,
  649.4518633856611, 460.7912718954633, 626.150462810664, 509.33585642670744, 593.1401453294179,
  530.6954736204549, 556.8935222127556, 559.9273870166451, 517.9197870310509, 582.4287517306153,
  484.11964343037323, 597.1560832290169, 459.03222473087396, 621.0274949086466, 438.11039022321154,
  651.3689440081158, 429.43667093843567, 686.3731150817684, 432.05029606733103, 726.1878666750503,
  421.6902139845064, 748.5744620042316, 397.8927935245363, 778.6337708564557, 367.5111094723503,
  792.6287871481064, 335.0802046803193, 795.4641381478963, 294.8623601925252, 790.3177294792127,
  255.26933447013639, 776.3228370821212, 225.344431214269, 746.3711518226298, 192.73203550406103,
  713.7991149596966, 199.06094085265394, 674.3068624609349, 207.5062077919911, 638.4763261746227,
  190.31310645331482, 613.6509940547375, 146.74931837304698, 621.5992452450397, 103.454341485492,
  665.5124383180124, 60.96567428151931, 716.1845355322713, 48.49595708249788, 763.6383682758693,
  51.23726133320403, 810.1045243122669, 71.53440096982465, 842.407749982487, 97.97907893142005,
  879.5993779794437, 131.14717279570036, 903.6790094213126, 175.24174017377706, 915.9471803279671,
  219.31612086267396, 902.1335310600084, 270.1561321514687, 880.1365756762476, 315.0232456643523,
  884.5103070340778, 370.89556334366307, 909.7723644212043, 407.9691345807976, 947.0675376346722,
  439.8492118274288, 990.6429384281869, 439.26727537005956, 1036.8675099917996, 414.23364852545194,
  1070.3264506272462, 387.0500494883014, 1100.6074853525497, 351.4546920217324, 1119.943854180156,
  306.7958514306488, 1128.5371035594999, 259.67124425611814, 1122.6651029017848, 208.79760059460207,
  1106.8898009575623, 162.16340658911932, 1082.4004208812885, 108.81054339506417, 1050.2046949092428,
  81.72759371897288, 1016.627194271211, 46.42875173061529
];

const foot = [
  [0, 0, 3, -1, 5, -3, 6, -4, 7, -3, 8, -1, 7, 2, 5, 3, 2, 2, 0, 0],
];

export default function FootstepCanvas() {
  const canvasRef = useRef(null);

  useEffect(() => {
    const canvas = canvasRef.current;
    if (!canvas) return;

    const ctx = canvas.getContext('2d');
    if (!ctx) return;

    const dpr = window.devicePixelRatio || 1;
    canvas.width = window.innerWidth * dpr;
    canvas.height = window.innerHeight * dpr;
    canvas.style.width = `${window.innerWidth}px`;
    canvas.style.height = `${window.innerHeight}px`;
    ctx.scale(dpr, dpr);

    ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
    ctx.fillStyle = 'white';

    const startX = document.getElementById('footstep-start')?.getBoundingClientRect().left || 100;
    const startY = document.getElementById('footstep-start')?.getBoundingClientRect().bottom || 100;

    let x = startX;
    let y = startY;
    let isLeft = true;

    for (let i = 0; i < path.length; i += 2) {
      const px = path[i];
      const py = path[i + 1];

      ctx.save();
      ctx.translate(px, py);

      const scale = 2.5;
      ctx.scale(scale, scale);

      const step = isLeft ? foot[0] : foot[0].map((v, i) => (i % 2 === 0 ? -v : v));
      ctx.beginPath();
      for (let j = 0; j < step.length; j += 2) {
        const fx = step[j];
        const fy = step[j + 1];
        if (j === 0) ctx.moveTo(fx, fy);
        else ctx.lineTo(fx, fy);
      }
      ctx.closePath();
      ctx.fill();

      ctx.restore();

      isLeft = !isLeft;
    }
  }, []);

  return <canvas ref={canvasRef} className='fixed top-0 left-0 z-0 pointer-events-none' />;
}
